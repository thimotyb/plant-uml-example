@startuml
actor Customer as C
participant "WebApp" as UI
participant "Payment Gateway" as PG

C -> UI : Pay(amount, token)
loop up to 3 attempts
  UI -> PG : authorize(amount, token)
  alt authorization OK
    PG --> UI : OK(paymentId)
    break
  else transient failure
    PG --> UI : FAILED(transient)
  end
end
opt all attempts failed
  UI --> C : show error and suggest alternative method
end
@enduml
